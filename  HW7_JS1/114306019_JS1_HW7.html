<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>1A2B Game</title>
</head>
<body>
	<h1>114306019_HW6_1A2B</h1>
	<p>Enter 4 unique numbers
	<input type="text"  id="inputField" rows="1" cols="20" required>
	<button onclick="myFunction()">Guess!</button>
	<div id="record"></div>

 	<script>
 	let count=0;
 	let answer = generateAnswer();

 	function generateAnswer() {
        let digits = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        let ans = [];
        for (let i = 0; i < 4; i++) {
            let idx = Math.floor(Math.random() * digits.length);
            ans.push(digits[idx]);
            digits.splice(idx, 1);
        }
            
        console.log("Cheating? Answer is: " + ans.join('')); 
        return ans.join('');
    }

	function isValid(str) {
        if (str.length !== 4) {
            alert("Input must be exactly 4 digits.");
            return false;
        }

        if (!/^\d{4}$/.test(str)) {
            alert("Input must be digits only.");
            return false;
        }

        if (new Set(str).size !== 4) {
            alert("Digits must not repeat.");
            return false;
        }
        return true;
    }


	function checkAB(guess, ans) {
        let A = 0, B = 0;
        let guessArr = guess.split('');
        let ansArr = ans.split('');
        for (let i = 0; i < 4; i++) {
            if (guessArr[i] === ansArr[i]) {
                A++;
            } else if (ansArr.includes(guessArr[i])) {
                B++;
            }
        }
        return `${A}A${B}B`;
    }

 	function myFunction() {
        let inputField = document.getElementById("inputField");
        let guess = inputField.value;

        if (!isValid(guess)) return;

        count++;
        let result = checkAB(guess, answer);


 		let recordDiv = document.getElementById("record");
        let p = document.createElement("p");

        p.textContent = `${count}. ${guess} â†’ ${result}`;
            recordDiv.appendChild(p);

        if (result === "4A0B") {
            alert(`Correct! You guessed ${count} times.`);        
        }
        inputField.value = "";
    }
 	</script>
 	

</body>
</html>